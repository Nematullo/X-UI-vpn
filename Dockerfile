# Используем официальный образ alireza7/x-ui как базовый
FROM alireza7/x-ui:latest

# Копируем сертификаты SSL/TLS в контейнер (если используете)
# Предполагается, что у вас есть папка 'certs' в корне вашего репозитория
# Пример:
COPY ./certs/fullchain.pem /etc/x-ui/cert.pem
COPY ./certs/privkey.pem /etc/x-ui/key.pem

# Копируем ваш готовый файл конфигурации X-UI (config.json)
# config.json ДОЛЖЕН быть настроен на использование порта 54321 для веб-интерфейса
# и на порты в диапазоне 2003-2025 для VPN-трафика
COPY ./config.json /etc/x-ui/config.json

# Устанавливаем права доступа для файлов конфигурации и сертификатов
RUN chmod 644 /etc/x-ui/config.json \
    && chmod 644 /etc/x-ui/cert.pem \
    && chmod 600 /etc/x-ui/key.pem

# Декларируем порты, которые будут использоваться ВНУТРИ контейнера
# Это важно для документации образа и для некоторых инструментов сканирования
EXPOSE 54321 # Внутренний порт веб-панели X-UI
EXPOSE 2003-2025 # Внутренние порты для VPN-трафика